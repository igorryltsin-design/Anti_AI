(function(){"use strict";const d=[{id:"struct-1",pattern:/\b([А-ЯЁA-Z][а-яёa-z]{2,})\s*:\s+\1\b/giu,description:"Повтор слова по обе стороны двоеточия (слово с заглавной буквы после двоеточия)",category:"structure",enabled:!0,replacement:(e,r)=>`${String(r)}: `},{id:"struct-2",pattern:/\b(данные|данных)\s*:\s+(данные|данных)\b/gi,description:"Повтор «данные/данных» вокруг двоеточия",category:"structure",enabled:!0,replacement:(e,r)=>`${String(r)}: `},{id:"struct-3",pattern:new RegExp("(?<![\\n.?!])\\s([А-ЯЁ][а-яё]{2,}(?:\\s+[А-ЯЁ][а-яё]{2,}){2,})","g"),description:"Последовательность 3+ слов с заглавной буквы в середине предложения (Title Case)",category:"structure",enabled:!0},{id:"struct-4",pattern:/\b(являет(?:ся|тесь|ся)|являлось|являлась|являлся|являлись)\b/gi,description:"Чрезмерное «является» как калька is",category:"structure",enabled:!0,replacement:""},{id:"struct-5",pattern:/\b(был[аио]?|будет|были|будут)\s+[а-яё]+н[а-яё]+(?:[а-яё]|ся)\b/gi,description:"Страдательный залог (была решена командой)",category:"structure",enabled:!0},{id:"intro-1",pattern:/в заключение,?/gi,description:'Вводная фраза "в заключение"',category:"transition",enabled:!0,replacement:""},{id:"intro-2",pattern:/важно отметить,? что/gi,description:'Фраза "важно отметить, что"',category:"filler",enabled:!0,replacement:""},{id:"intro-3",pattern:/следует отметить,? что/gi,description:'Фраза "следует отметить, что"',category:"filler",enabled:!0,replacement:""},{id:"intro-4",pattern:/стоит упомянуть,? что/gi,description:'Фраза "стоит упомянуть, что"',category:"filler",enabled:!0,replacement:""},{id:"intro-5",pattern:/необходимо подчеркнуть,? что/gi,description:'Фраза "необходимо подчеркнуть, что"',category:"filler",enabled:!0,replacement:""},{id:"intro-6",pattern:/подводя итоги?,?/gi,description:'Фраза "подводя итоги"',category:"transition",enabled:!0,replacement:""},{id:"intro-7",pattern:/в данном контексте,?/gi,description:'Фраза "в данном контексте"',category:"filler",enabled:!0,replacement:""},{id:"intro-8",pattern:/не стоит забывать,? что/gi,description:'Фраза "не стоит забывать, что"',category:"filler",enabled:!0,replacement:""},{id:"intro-9",pattern:/как уже было сказано,?/gi,description:'Фраза "как уже было сказано"',category:"filler",enabled:!0,replacement:""},{id:"intro-10",pattern:/в первую очередь,?/gi,description:'Фраза "в первую очередь"',category:"transition",enabled:!0},{id:"intro-11",pattern:/прежде всего,?/gi,description:'Фраза "прежде всего"',category:"transition",enabled:!0},{id:"intro-12",pattern:/в целом,?/gi,description:'Фраза "в целом"',category:"filler",enabled:!0},{id:"intro-13",pattern:/с уверенностью можно сказать,? что/gi,description:'Фраза "с уверенностью можно сказать"',category:"filler",enabled:!0,replacement:""},{id:"intro-14",pattern:/нельзя не отметить,? что/gi,description:'Фраза "нельзя не отметить"',category:"filler",enabled:!0,replacement:""},{id:"intro-15",pattern:/очевидно,? что/gi,description:'Фраза "очевидно, что"',category:"filler",enabled:!0},{id:"trans-1",pattern:/кроме того,?/gi,description:'Переход "кроме того"',category:"transition",enabled:!0},{id:"trans-2",pattern:/более того,?/gi,description:'Переход "более того"',category:"transition",enabled:!0},{id:"trans-3",pattern:/таким образом,?/gi,description:'Переход "таким образом"',category:"transition",enabled:!0},{id:"trans-4",pattern:/в связи с этим,?/gi,description:'Переход "в связи с этим"',category:"transition",enabled:!0},{id:"trans-5",pattern:/с другой стороны,?/gi,description:'Переход "с другой стороны"',category:"transition",enabled:!0},{id:"trans-6",pattern:/вместе с тем,?/gi,description:'Переход "вместе с тем"',category:"transition",enabled:!0},{id:"trans-7",pattern:/следовательно,?/gi,description:'Переход "следовательно"',category:"transition",enabled:!0},{id:"trans-8",pattern:/исходя из вышесказанного,?/gi,description:'Переход "исходя из вышесказанного"',category:"transition",enabled:!0,replacement:""},{id:"amp-1",pattern:/крайне важно/gi,description:'Усилитель "крайне важно"',category:"filler",enabled:!0},{id:"amp-2",pattern:/чрезвычайно важно/gi,description:'Усилитель "чрезвычайно важно"',category:"filler",enabled:!0},{id:"amp-3",pattern:/безусловно,?/gi,description:'Усилитель "безусловно"',category:"filler",enabled:!0},{id:"amp-4",pattern:/несомненно,?/gi,description:'Усилитель "несомненно"',category:"filler",enabled:!0},{id:"amp-5",pattern:/абсолютно/gi,description:'Усилитель "абсолютно"',category:"filler",enabled:!0},{id:"amp-6",pattern:/принципиально важно/gi,description:'Усилитель "принципиально важно"',category:"filler",enabled:!0},{id:"amp-7",pattern:/игра(е|ю)т важную роль/gi,description:'Фраза "играет важную роль"',category:"filler",enabled:!0},{id:"filler-1",pattern:/в (данной|настоящей) (работе|статье|главе)/gi,description:'Фраза "в данной работе/статье/главе"',category:"filler",enabled:!0},{id:"filler-2",pattern:/как показывает практика/gi,description:'Фраза "как показывает практика"',category:"filler",enabled:!0},{id:"filler-3",pattern:/в (современном|нынешнем|сегодняшнем) мире/gi,description:'Фраза "в современном/нынешнем мире"',category:"filler",enabled:!0},{id:"filler-4",pattern:/результаты (исследования|анализа) показывают,?\s+что/gi,description:'Фраза "результаты исследования показывают, что"',category:"filler",enabled:!0},{id:"filler-5",pattern:/нельзя отрицать тот факт,?\s+что/gi,description:'Фраза "нельзя отрицать тот факт, что"',category:"filler",enabled:!0},{id:"filler-6",pattern:/погружаясь в (эту|данную) тему/gi,description:'Фраза "погружаясь в эту тему"',category:"filler",enabled:!0},{id:"filler-7",pattern:/в мире (цифровых технологий|современных технологий)/gi,description:'Фраза "в мире цифровых технологий"',category:"filler",enabled:!0},{id:"filler-8",pattern:/важно учитывать контекст/gi,description:'Повторяемая фраза "важно учитывать контекст"',category:"filler",enabled:!0},{id:"filler-9",pattern:/в контексте (данной|текущей) (темы|задачи|работы)/gi,description:'Фраза "в контексте данной темы"',category:"filler",enabled:!0},{id:"filler-10",pattern:/это сделает разницу/gi,description:'Калька make a difference: "сделает разницу"',category:"phrase",enabled:!0,replacement:"изменит ситуацию"},{id:"filler-11",pattern:/волнующий опыт/gi,description:'Калька excited experience: "волнующий опыт"',category:"phrase",enabled:!0,replacement:"захватывающий опыт"},{id:"filler-12",pattern:/он покачал своей головой|я положил руку в свой карман/gi,description:'Избыточные притяжательные местоимения ("своей головой", "в свой карман")',category:"phrase",enabled:!0},{id:"en-1",pattern:/in conclusion,?/gi,description:'English: "in conclusion"',category:"transition",enabled:!0},{id:"en-2",pattern:/it'?s important to note that/gi,description:`English: "it's important to note that"`,category:"filler",enabled:!0},{id:"en-3",pattern:/it'?s worth mentioning that/gi,description:`English: "it's worth mentioning that"`,category:"filler",enabled:!0},{id:"en-4",pattern:/furthermore,?/gi,description:'English: "furthermore"',category:"transition",enabled:!0},{id:"en-5",pattern:/moreover,?/gi,description:'English: "moreover"',category:"transition",enabled:!0},{id:"en-6",pattern:/additionally,?/gi,description:'English: "additionally"',category:"transition",enabled:!0},{id:"en-7",pattern:/in summary,?/gi,description:'English: "in summary"',category:"transition",enabled:!0},{id:"en-8",pattern:/to summarize,?/gi,description:'English: "to summarize"',category:"transition",enabled:!0},{id:"en-9",pattern:/it can be argued that/gi,description:'English: "it can be argued that"',category:"filler",enabled:!0},{id:"en-10",pattern:/on the other hand,?/gi,description:'English: "on the other hand"',category:"transition",enabled:!0},{id:"en-11",pattern:/delve into/gi,description:'English: "delve into"',category:"phrase",enabled:!0},{id:"en-12",pattern:/it is crucial (to|that)/gi,description:'English: "it is crucial"',category:"filler",enabled:!0},{id:"en-13",pattern:/at the end of the day,?/gi,description:'English: "at the end of the day"',category:"transition",enabled:!0},{id:"en-14",pattern:/it'?s essential to/gi,description:`English: "it's essential to"`,category:"filler",enabled:!0},{id:"en-15",pattern:/in today'?s (world|society|age)/gi,description:`English: "in today's world/society"`,category:"filler",enabled:!0},{id:"en-16",pattern:/a testament to/gi,description:'English: "a testament to"',category:"phrase",enabled:!0},{id:"en-17",pattern:/navigating the (complexities|landscape|world)/gi,description:'English: "navigating the complexities"',category:"phrase",enabled:!0},{id:"en-18",pattern:/in the realm of/gi,description:'English: "in the realm of"',category:"phrase",enabled:!0},{id:"en-19",pattern:/a myriad of/gi,description:'English: "a myriad of"',category:"phrase",enabled:!0},{id:"en-20",pattern:/it'?s worth noting that/gi,description:`English: "it's worth noting that"`,category:"filler",enabled:!0},{id:"en-21",pattern:/leverag(e|ing)/gi,description:'English: "leverage/leveraging"',category:"phrase",enabled:!0},{id:"en-22",pattern:/holistic approach/gi,description:'English: "holistic approach"',category:"phrase",enabled:!0},{id:"en-23",pattern:/paradigm shift/gi,description:'English: "paradigm shift"',category:"phrase",enabled:!0},{id:"en-24",pattern:/synergy|synergistic/gi,description:'English: "synergy"',category:"phrase",enabled:!0},{id:"en-25",pattern:/game[- ]?changer/gi,description:'English: "game-changer"',category:"phrase",enabled:!0}],u={structure:"high",phrase:"medium",transition:"low",filler:"low"},h={low:.85,medium:1,high:1.35},f=new Set(["США","СССР","РФ","ООН","ЕС","EU","NASA","AI","ИИ"]);function y(e){return e.length>1&&e===e.toUpperCase()&&/[A-ZА-ЯЁ]/.test(e)}function m(e,r,i){const n=e.lastIndexOf(`
`,r)+1,t=e.indexOf(`
`,i),a=e.slice(n<0?0:n,t===-1?e.length:t).trim();if(!a)return!1;const s=a.length<=120,o=(a.match(/[a-zа-яё]/g)||[]).length<a.length*.35;return s&&(y(a)||o)}function b(e){return/\b[А-ЯЁA-Z]{2,}\b/.test(e)}function E(e){const r=e.trim().split(/\s+/).filter(Boolean).slice(0,5);return!(r.length<2||r.length>4||!r.every(t=>/^[А-ЯЁ][а-яё-]+$/u.test(t))||!r.some(t=>/(вич|вна|ична|евич|ович|евна|овна)$/iu.test(t))||!r.some(t=>/(ов|ев|ин|ын|ский|цкий|ова|ева|ина|ына|ская|цкая)$/iu.test(t)))}function v(e,r,i,n){return!!(f.has(n.toUpperCase())||b(n)||m(e,r,i)||E(n))}function w(e){return e.reduce((r,i)=>(r[i.severity]+=1,r),{low:0,medium:0,high:0})}function x(e){const r=Math.min(e.length/40,1.2),i=/\b(\w+)\b.*\b\1\b/.test(e)?1.1:1;return Number((1+(r-.5)*.2)*i)}function S(e,r){if(!e.length||r===0)return 0;const i=e.reduce((s,o)=>s+o.score,0),n=Math.max(1,r/1200),t=i/n,a=Math.min(1,t/5);return Number(a.toFixed(3))}function R(e,r=d){const i=P(e,r),n=w(i),t=S(i,e.length),a=A(e,r),s={invisibleCharsRemoved:0,quotesNormalized:0,dashesNormalized:0,emptyLinesRemoved:0,aiPatternsFound:i.length,aiPatternsRemoved:a.count,totalChanges:a.count,aiSuspicionScore:t,aiSeverity:n};return{cleanedText:e,originalText:e,stats:s,suspiciousRanges:i,suspicionScore:t,severityHistogram:n,softFixPreview:a.text}}function P(e,r=d){const i=[];for(const n of r){if(!n.enabled)continue;const t=n.pattern instanceof RegExp?n.pattern.flags:"gi",a=t.includes("g")?t:`${t}g`,s=n.pattern instanceof RegExp?new RegExp(n.pattern.source,a):new RegExp(`\\b${n.pattern}\\b`,a);let o;for(;(o=s.exec(e))!==null;){const l=(o[0]||"").trim();if(l.length<3)continue;const c=o.index,g=o.index+o[0].length;if(v(e,c,g,l))continue;const p=n.severity??u[n.category]??"medium",z=n.weight??h[p],C=x(l),M=Number((z*C).toFixed(3)),F=e.slice(Math.max(0,c-40),Math.min(e.length,g+40));i.push({start:c,end:g,pattern:n.description,category:n.category,severity:p,score:M,patternId:n.id,context:F})}}return i.sort((n,t)=>n.start-t.start)}function A(e,r=d){let i=e,n=0;for(const t of r){if(!t.enabled||t.replacement===void 0)continue;const a=t.pattern instanceof RegExp?t.pattern.flags:"gi",s=a.includes("g")?a:`${a}g`,o=t.pattern instanceof RegExp?new RegExp(t.pattern.source,s):new RegExp(t.pattern,s),l=i.match(o);if(l){n+=l.length;const c=t.replacement;i=i.replace(o,c)}}return i=i.replace(/  +/g," "),i=i.replace(/([.!?])\s+\s+/g,"$1 "),{text:i,count:n}}function I(e){return e.kind==="string"?e.value:new RegExp(e.source,e.flags)}function $(e,r){const i=d.map(t=>({...t,enabled:Object.prototype.hasOwnProperty.call(e,t.id)?e[t.id]:t.enabled})),n=r.map(t=>({id:t.id,enabled:t.enabled,pattern:I(t.pattern),description:t.description,category:t.category,severity:t.severity,weight:t.weight}));return[...i,...n]}self.onmessage=e=>{const r=e.data;if(!(!r||r.type!=="detect"))try{const i=$(r.enabledById,r.customPatterns),n=R(r.text,i),t={type:"result",requestId:r.requestId,result:n};self.postMessage(t)}catch(i){const n={type:"error",requestId:r.requestId,error:i instanceof Error?i.message:String(i)};self.postMessage(n)}}})();
